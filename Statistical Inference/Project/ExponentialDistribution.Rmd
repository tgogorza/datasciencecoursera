---
title: "Exponential Distribution"
author: "Tomas Gogorza"
date: "Monday, September 7, 2015"
output: html_document
---

#Overview

This report conducts contains 2 parts. The first portion of the report is an investigation of the exponential distribution, with focus on taking a sample set and comparing theoretical and sample means, as well as showing distributions.
The second part of the report will focus on performing some exploratory data analyses on the ToothGrowth data set to compare tooth growth.

#Part I
##1.1 Simulations


Set up simulation variables
```{r}
lambda <- 0.2
#No. of simulations
nsim <- 1000
#No. of samples per simulation
n <- 40
```

Run 1000 simulations, take 40 samples from an exponential distribution for each one.
The samples are arranged into a 1000x40 matrix, where each row representas a simulation with 40 samples.
```{r}
simulations <- matrix(rexp(nsim * n,lambda), nsim)
```

Calculate the mean and variance of each simulation. Store them on a list of 1000 items, where each element represent the mean (or variance) of one simulation.
```{r}
mns <- apply(simulations, 1, mean)
vars <- apply(simulations, 1, var)
```

##1.2 Sample Mean vs Theoretical Mean


The theoretical mean for an exponential distribution is $1/\lambda$:
```{r}
mean <- 1/lambda
mean
```

To measure the sample mean, we'll get the list of means previously calculated and extract the mean of that list:
```{r}
samplemean <- mean(mns)
samplemean
```

We can see that the sample mean taken from the means of 1000 simulations is very similar to the theoretical mean for the exponential distribution
Theoretical mean: **`r mean`**  
Sample mean: **`r samplemean`**

Draw comparative plots:
```{r fig.width=12, fig.height=12}
par(mfrow=c(2,1))
hist(simulations,breaks = 50, xlab="Sample value", main="Plot1: Theoretical mean")
abline(v = mean, col = "blue", lwd = 2)
text(mean+3, 5000 , paste("theoretical mean:", mean), pos = 4, col="blue")
hist(simulations,breaks = 50, xlab="Sample value", main="Plot2: Sample mean")
abline(v = samplemean, col = "red", lwd = 2)
text(samplemean+3, 5000 , paste("sample mean:", samplemean), pos = 4, col="red")
```

**Plot1.** Histogram of random samples and theoretical mean taken from an exponential distribution  
**Plot2.** Histogram of random samples and sample mean taken from an exponential distribution

##1.3 Sample Variance vs Theoretical Variance


Since $sd=\sqrt{var(X)}$, then $var(X)=sd^{2}$, therefore, given that for an exponential distribution $sd=1/\lambda$, the theoretical variance for an exponential distribution should be $1/\lambda^{2}$:
```{r}
sd <- 1/lambda
var <- sd^2
var
```

To measure the sample variance, we'll get the list of variances previously calculated and extract the mean of that list:
```{r}
samplevar <- mean(vars)
samplevar
```

We can effectively see that the sample variance taken from the variances of 1000 simulations is very similar to the theoretical variance for the exponential distribution
Theoretical variance: **`r var`**  
Sample variance: **`r samplevar`**

Draw comparative plots:
```{r fig.width=12, fig.height=12}
par(mfrow=c(2,1))
hist(simulations,breaks = 50, xlab="Sample value", main="Plot3: Theoretical variance")
abline(v = mean, col = "blue", lwd = 1)
abline(v = var, col = "blue", lwd = 2)
text(var+3, 5000 , paste("theoretical var:", var), pos = 4, col="blue")
hist(simulations,breaks = 50, xlab="Sample value", main="Plot4: Sample variance")
abline(v = samplemean, col = "red", lwd = 1)
abline(v = samplevar, col = "red", lwd = 2)
text(samplevar+3, 5000 , paste("sample var:", samplevar), pos = 4, col="red")
```

**Plot3.** Histogram of random samples, theoretical mean and theoretical variance taken from an exponential distribution  
**Plot4.** Histogram of random samples, sample mean and sample variance taken from an exponential distribution

##1.4 Distribution

```{r fig.width=12, fig.height=12}
par(mfrow=c(2,1))
hist(rexp(nsim * n,lambda),breaks=50)
hist(mns,breaks=50)
```